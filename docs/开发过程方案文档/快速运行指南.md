# 快速运行指南 - SunEyeVision 工作流执行引擎优化

## 🚀 立即开始

### 1. 运行应用

```bash
# 进入UI项目输出目录
cd d:/MyWork/SunEyeVision/SunEyeVision/SunEyeVision.UI/bin/Release/net9.0-windows7.0

# 运行应用
SunEyeVision.UI.exe
```

### 2. 在工作流画布中测试优化效果

#### 测试1: 顺序工作流(验证策略选择)
1. 创建节点: `blur1` → `edge1` → `thresh1`
2. 不使用Start节点
3. 连接: `blur1` → `edge1` → `thresh1`
4. 执行工作流
5. **预期**: 日志显示"选择执行策略: Sequential"

#### 测试2: 并行工作流(验证性能提升)
1. 创建节点:
   ```
         → blur1
   start → edge1
         → thresh1
   ```
2. 连接: `start` → `blur1`, `start` → `edge1`, `start` → `thresh1`
3. 执行工作流
4. **预期**: 日志显示"选择执行策略: Parallel",执行时间明显缩短

#### 测试3: 混合工作流(验证混合执行)
1. 创建节点:
   ```
   start1 → blur1 → edge1
   start2 → gray1 → thresh1
   ```
2. 连接: `start1` → `blur1` → `edge1`, `start2` → `gray1` → `thresh1`
3. 执行工作流
4. **预期**: 日志显示"选择执行策略: Hybrid"

## 📊 验证优化效果

### 查看日志输出

执行工作流后,在日志窗口中查看:

```
[INFO]  选择执行策略: XXX
[INFO]  使用XXX执行模式
[INFO]  ========== 节点执行顺序 ==========
[INFO]    [1] node1 - XXX
[INFO]    [2] node2 - XXX
[INFO]  [1/2] 开始执行节点: XXX
...
[INFO]  工作流执行完成: XXX, 耗时: XXXms
```

### 性能对比

执行相同工作流2次,对比执行时间:

| 测试 | 第一次 | 第二次 | 提升 |
|-----|-------|-------|------|
| 顺序工作流 | ___ms | ___ms | ___% |
| 并行工作流 | ___ms | ___ms | ___% |
| 混合工作流 | ___ms | ___ms | ___% |

**预期提升**:
- 并行执行: 40-80%
- 混合执行: 20-60%
- 缓存命中: 80-95%

## 🧪 运行自动化测试(可选)

如果需要运行完整的测试套件:

### 方法1: 在应用中集成测试

**步骤1**: 在`SunEyeVision.UI/Services/`创建`TestExecutionService.cs`

**步骤2**: 在`MainWindow.xaml`中添加测试菜单

**步骤3**: 在`MainWindowViewModel.cs`中添加测试命令

详细代码参考: `docs/快速开始-运行测试.md`

### 方法2: 创建独立测试项目

```bash
# 创建控制台测试项目
cd d:/MyWork/SunEyeVision/SunEyeVision
dotnet new console -n SunEyeVision.Tests -f net9.0

# 编辑项目文件,添加引用
# (参考 docs/快速开始-运行测试.md)

# 复制测试文件
cp SunEyeVision.Workflow/WorkflowExecutionTests.cs SunEyeVision.Tests/
cp SunEyeVision.Workflow/TestRunner.cs SunEyeVision.Tests/

# 创建Program.cs(参考 docs/快速开始-运行测试.md)

# 运行测试
cd SunEyeVision.Tests
dotnet run
```

## 🔍 查看构建输出

### DLL输出位置

```
SunEyeVision.PluginSystem/bin/Release/net9.0/SunEyeVision.PluginSystem.dll
SunEyeVision.Core/bin/Release/net9.0/SunEyeVision.Core.dll
SunEyeVision.Workflow/bin/Release/net9.0/SunEyeVision.Workflow.dll
SunEyeVision.UI/bin/Release/net9.0-windows7.0/SunEyeVision.UI.exe
```

### 测试相关文件

```
SunEyeVision.Workflow/WorkflowExecutionTests.cs
SunEyeVision.Workflow/TestRunner.cs
```

## 📝 记录测试结果

### 创建测试报告

在运行测试后,记录:

1. **执行时间**
   - 顺序工作流: ___ms
   - 并行工作流: ___ms
   - 混合工作流: ___ms
   - 缓存命中: ___ms

2. **性能提升**
   - 并行执行提升: ___%
   - 混合执行提升: ___%
   - 缓存命中提升: ___%

3. **遇到的问题**
   - 问题描述: ___
   - 严重性: [ ] 低 [ ] 中 [ ] 高
   - 解决方案: ___

### 更新检查清单

使用`docs/优化完成检查清单.md`记录所有验证项目。

## 🐛 遇到问题?

### 常见问题

**Q1: 应用无法启动**
```
A: 确保所有DLL文件在同一目录
   SunEyeVision.UI.exe
   SunEyeVision.Core.dll
   SunEyeVision.PluginSystem.dll
   SunEyeVision.Workflow.dll
```

**Q2: 工作流执行失败**
```
A: 查看日志窗口的详细错误信息
   - 检查节点连接是否正确
   - 检查插件是否加载
   - 检查输入图像是否有效
```

**Q3: 性能提升不明显**
```
A: 检查以下几点:
   - 确认使用了正确的策略(查看日志)
   - 确认节点支持并行(查看ToolMetadata)
   - 确认缓存TTL未过期
   - 尝试更复杂的工作流
```

**Q4: 策略选择不符合预期**
```
A: 查看工作流分析日志
   - 检查节点数量
   - 检查Start节点数量
   - 检查节点特性配置
   - 参考 docs/工作流执行引擎优化方案.md 的策略选择规则
```

## 📚 相关文档

所有详细文档位于`docs/`目录:

| 文档 | 说明 |
|-----|------|
| **工作流执行引擎优化方案.md** | 完整的优化方案和技术细节 |
| **工作流执行引擎优化实施总结.md** | 实施过程和成果总结 |
| **SunEyeVision真实测试框架指南.md** | 测试框架完整指南 |
| **快速开始-运行测试.md** | 测试集成快速开始 |
| **优化完成检查清单.md** | 验证检查清单 |
| **构建结果报告.md** | 本次构建的详细报告 |

## ✅ 验证清单

运行应用后,验证以下功能:

- [ ] 应用正常启动
- [ ] 工作流可以正常执行
- [ ] 日志显示策略选择信息
- [ ] 节点执行顺序正确
- [ ] 并行工作流性能提升明显
- [ ] 混合工作流执行正确

## 🎯 下一步

### 今天
1. ⬜ 运行应用,创建测试工作流
2. ⬜ 执行3种类型的工作流(顺序/并行/混合)
3. ⬜ 记录执行时间和性能提升
4. ⬜ 查看日志,验证策略选择正确

### 本周
1. ⬜ 集成测试服务到应用
2. ⬜ 运行完整的5个测试用例
3. ⬜ 记录所有测试结果
4. ⬜ 填写优化完成检查清单
5. ⬜ 提供反馈和改进建议

### 下周
1. ⬜ 根据测试反馈优化代码
2. ⬜ 处理发现的警告
3. ⬜ 添加更多测试用例
4. ⬜ 准备下一阶段优化计划

---

**现在就开始吧!运行应用,测试优化效果!** 🚀
