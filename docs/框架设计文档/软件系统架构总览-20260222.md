┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              系统架构总览                                             │
├─────────────────────────────────────────────────────────────────────────────────────┤
│                                                                                     │
│   ┌─────────────────────────────────────────────────────────────────────────────┐  │
│   │                          用户界面层                              │  │
│   │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │  │
│   │  │  主窗口     │ │  工具箱     │ │  画布编辑器 │ │  属性面板   │           │  │
│   │  │ MainWindow  │ │  Toolbox    │ │  Diagram    │ │  Property   │           │  │
│   │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘           │  │
│   │                              ↓ MVVM绑定                                      │  │
│   │  ┌─────────────────────────────────────────────────────────────────────┐   │  │
│   │  │                    ViewModels (视图模型层)                           │   │  │
│   │  │  MainWindowVM • WorkflowVM • ToolboxVM • PropertyPanelVM • ...      │   │  │
│   │  └─────────────────────────────────────────────────────────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────────┘  │
│                                        │                                           │
│                                        ▼                                           │
│   ┌─────────────────────────────────────────────────────────────────────────────┐  │
│   │                        工作流引擎层                              │  │
│   │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐               │  │
│   │  │ WorkflowEngine  │ │ ExecutionEngine │ │ WorkflowContext │               │  │
│   │  │  工作流模型      │ │  执行控制        │ │  执行上下文      │               │  │
│   │  └─────────────────┘ └─────────────────┘ └─────────────────┘               │  │
│   │                              ↓ 节点系统                                      │  │
│   │  ┌─────────────────────────────────────────────────────────────────────┐   │  │
│   │  │ AlgorithmNode • SubroutineNode • ConditionNode • WorkflowNode       │   │  │
│   │  └─────────────────────────────────────────────────────────────────────┘   │  │
│   └─────────────────────────────────────────────────────────────────────────────┘  │
│                                        │                                           │
│          ┌─────────────────────────────┼─────────────────────────────┐            │
│          ▼                             ▼                             ▼            │
│   ┌─────────────────┐     ┌─────────────────────┐     ┌─────────────────────┐    │
│   │  核心领域层      │     │   插件基础设施层     │     │    设备驱动层        │    │
│   │     Core        │     │ Plugin.Infrastructure│     │   DeviceDriver      │    │
│   │ ┌─────────────┐ │     │ ┌─────────────────┐ │     │ ┌─────────────────┐ │    │
│   │ │ 图像处理核心 │ │     │ │ PluginLoader    │ │     │ │ DeviceManager   │ │    │
│   │ │ ILogger     │ │     │ │ PluginManager   │ │     │ │ SimulatedCamera │ │    │
│   │ │ FileAccess  │ │     │ │ ToolRegistry    │ │     │ │ BaseDriver      │ │    │
│   │ └─────────────┘ │     │ └─────────────────┘ │     │ └─────────────────┘ │    │
│   └─────────────────┘     └─────────────────────┘     └─────────────────────┘    │
│          │                             │                             │            │
│          └─────────────────────────────┼─────────────────────────────┘            │
│                                        ▼                                           │
│   ┌─────────────────────────────────────────────────────────────────────────────┐  │
│   │                         SDK契约层                            │  │
│   │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐               │  │
│   │  │ IImageProcessor │ │ AlgorithmParams │ │ AlgorithmResult │               │  │
│   │  └─────────────────┘ └─────────────────┘ └─────────────────┘               │  │
│   │  ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐               │  │
│   │  │ IToolPlugin     │ │ IVisionPlugin   │ │ IWorkflowCtrl   │               │  │
│   │  └─────────────────┘ └─────────────────┘ └─────────────────┘               │  │
│   │                              ✅ 零依赖                                       │  │
│   └─────────────────────────────────────────────────────────────────────────────┘  │
│                                        ↑                                           │
│   ┌─────────────────────────────────────────────────────────────────────────────┐  │
│   │                           插件工具层                             │  │
│   │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │  │
│   │  │ ColorConvert│ │EdgeDetection│ │ GaussianBlur│ │ImageCapture │           │  │
│   │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘           │  │
│   │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐           │  │
│   │  │ ImageSave   │ │    OCR      │ │   ROICrop   │ │Threshold    │           │  │
│   │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘           │  │
│   │  ┌─────────────┐ ┌─────────────┐                                           │  │
│   │  │TemplateMatch│ │             │                                           │  │
│   │  └─────────────┘ └─────────────┘                                           │  │
│   │                        ✅ 只依赖SDK                                         │  │
│   └─────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                     │
└─────────────────────────────────────────────────────────────────────────────────────┘
