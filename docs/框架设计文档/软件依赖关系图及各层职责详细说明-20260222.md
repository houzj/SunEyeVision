1.ASCII 框图表达依赖关系：
┌─────────────────────────────────────────────────────────────────────────────────┐
│                        SunEyeVision 依赖关系图                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   Layer 4: 表现层                                                               │
│   ┌─────────────────────────────────────────────────────────────────────────┐  │
│   │                              UI (WPF)                                    │  │
│   │                        主程序入口 net9.0-windows                         │  │
│   │  ┌───────────┬───────────┬───────────┬───────────┬───────────┐         │  │
│   │  │   Core    │ Workflow  │ Device    │   SDK     │  Infra    │         │  │
│   │  └─────┬─────┴─────┬─────┴─────┬─────┴─────┬─────┴─────┬─────┘         │  │
│   └────────┼───────────┼───────────┼───────────┼───────────┼────────────────┘  │
│            │           │           │           │           │                    │
│            │           │           │           │           │                    │
│   ─────────┼───────────┼───────────┼───────────┼───────────┼────────────────    │
│   Layer 3: │应用层     │           │           │           │                    │
│            │           ▼           │           │           │                    │
│            │   ┌───────────────────┐│           │           │                    │
│            │   │    Workflow       ││           │           │                    │
│            │   │  工作流引擎        ││           │           │                    │
│            │   │ net9.0-windows    ││           │           │                    │
│            │   │ ┌───────┬─────┬───┐│           │           │                    │
│            │   │ │ Core  │ SDK │Inf││           │           │                    │
│            │   │ └───┬───┴──┬──┴───┘│           │           │                    │
│            │   └─────┼──────┼───────┘           │           │                    │
│            │         │      │                   │           │                    │
│   ─────────┼─────────┼──────┼───────────────────┼───────────┼────────────────    │
│   Layer 2: │基础设施层│      │                   │           │                    │
│            │         │      │                   │           ▼                    │
│            │         │      │         ┌─────────────────────────────────────┐    │
│            │         │      │         │      Plugin.Infrastructure          │    │
│            │         │      │         │        插件管理基础设施               │    │
│            │         │      │         │        net9.0-windows               │    │
│            │         │      │         │  ┌─────────────┬─────────────┐      │    │
│            │         │      │         │  │    Core     │     SDK     │      │    │
│            │         │      │         │  └─────────────┴─────────────┘      │    │
│            │         │      │         └─────────────────────────────────────┘    │
│            │         │      │                           │                        │
│            │         │      │                           │                        │
│            │         │      │   ┌───────────────────┐   │                        │
│            │         │      │   │   DeviceDriver    │   │                        │
│            │         │      │   │    设备驱动        │   │                        │
│            │         │      │   │    net9.0         │   │                        │
│            │         │      │   │  ┌─────────────┐  │   │                        │
│            │         │      │   │  │    Core     │  │   │                        │
│            │         │      │   │  └─────────────┘  │   │                        │
│            │         │      │   └───────────────────┘   │                        │
│            │         │      │                           │                        │
│   ─────────┼─────────┼──────┼───────────────────────────┼────────────────────    │
│   Layer 1: │领域层   │      │                           │                        │
│            │         │      │                           │                        │
│            │         │      │                           │                        │
│            │         ▼      ▼                           ▼                        │
│            │   ┌───────────────────────────────────────────────────────────┐    │
│            │   │                        Core                              │    │
│            │   │                    核心业务逻辑                           │    │
│            │   │                      net9.0                              │    │
│            │   │   ┌─────────────────────────────────────────────────┐    │    │
│            │   │   │              Plugin.Abstractions                │    │    │
│            │   │   │                     SDK                         │    │    │
│            │   │   └─────────────────────────────────────────────────┘    │    │
│            │   │                                                           │    │
│            │   │   ✅ Core 实现 SDK 接口 (依赖反转)                        │    │
│            │   │   ✅ 包含: 图像处理、日志、文件管理                        │    │
│            │   └───────────────────────────────────────────────────────────┘    │
│            │                                                                   │
│   ─────────┼────────────────────────────────────────────────────────────────   │
│   Layer 0: │SDK层                                                              │
│            │                                                                   │
│            │   ┌───────────────────────────────────────────────────────────┐   │
│            │   │                Plugin.Abstractions                        │   │
│            │   │                    插件开发SDK                            │   │
│            │   │                     net9.0                                │   │
│            │   │                                                          │   │
│            │   │   ┌──────────────────────────────────────────────────┐   │   │
│            │   │   │              ✅ 零依赖，纯契约层                   │   │   │
│            │   │   │                                                  │   │   │
│            │   │   │  • IImageProcessor    图像处理器接口             │   │   │
│            │   │   │  • AlgorithmParameters 算法参数基类              │   │   │
│            │   │   │  • AlgorithmResult     算法结果基类              │   │   │
│            │   │   │  • IVisionPlugin       视觉插件接口              │   │   │
│            │   │   │  • IToolPlugin         工具插件接口              │   │   │
│            │   │   └──────────────────────────────────────────────────┘   │   │
│            │   └───────────────────────────────────────────────────────────┘   │
│            │                                                                   │
└────────────┼───────────────────────────────────────────────────────────────────┘
             │
             │
   ┌─────────┴───────────────────────────────────────────────────────────────────┐
   │ Layer 4: 插件层 (可独立开发)                                                  │
   │                                                                             │
   │   ┌─────────────────────────────────────────────────────────────────────┐  │
   │   │                    Tool Plugins (9个工具)                           │  │
   │   │                                                                     │  │
   │   │   ┌───────────────┬───────────────┬───────────────┐                │  │
   │   │   │ ColorConvert  │ EdgeDetection │ GaussianBlur  │                │  │
   │   │   │   颜色转换     │   边缘检测     │   高斯模糊    │                │  │
   │   │   └───────────────┴───────────────┴───────────────┘                │  │
   │   │   ┌───────────────┬───────────────┬───────────────┐                │  │
   │   │   │ ImageCapture  │  ImageSave    │     OCR       │                │  │
   │   │   │   图像采集     │   图像保存     │   文字识别    │                │  │
   │   │   └───────────────┴───────────────┴───────────────┘                │  │
   │   │   ┌───────────────┬───────────────┬───────────────┐                │  │
   │   │   │   ROICrop     │TemplateMatch  │   Threshold   │                │  │
   │   │   │   ROI裁剪     │   模板匹配     │   阈值处理    │                │  │
   │   │   └───────────────┴───────────────┴───────────────┘                │  │
   │   │                                                                     │  │
   │   │   ┌─────────────────────────────────────────────────────────────┐  │  │
   │   │   │                       SDK ONLY                              │  │  │
   │   │   │                                                             │  │  │
   │   │   │  ✅ 工具只需引用 Plugin.Abstractions                        │  │  │
   │   │   │  ✅ 无需 Core 源码，可独立开发                               │  │  │
   │   │   │  ✅ 无任何 NuGet 依赖                                        │  │  │
   │   │   │  ✅ 输出到 UI/bin/.../plugins/ 目录                          │  │  │
   │   │   └─────────────────────────────────────────────────────────────┘  │  │
   │   └─────────────────────────────────────────────────────────────────────┘  │
   │                                                                             │
   └─────────────────────────────────────────────────────────────────────────────┘


2.编译输出目录结构
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            编译输出结构                                          │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│   src/UI/bin/Debug/net9.0-windows/                                              │
│   │                                                                             │
│   │  ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  │                        主程序及核心依赖                              │   │
│   │  │                                                                     │   │
│   │  │   SunEyeVision.UI.exe              ← 主程序入口                    │   │
│   │  │   SunEyeVision.Core.dll             ← 核心业务逻辑                 │   │
│   │  │   SunEyeVision.Workflow.dll         ← 工作流引擎                   │   │
│   │  │   SunEyeVision.DeviceDriver.dll     ← 设备驱动                     │   │
│   │  │   SunEyeVision.Plugin.Abstractions.dll  ← SDK契约                  │   │
│   │  │   SunEyeVision.Plugin.Infrastructure.dll ← 插件基础设施            │   │
│   │  │                                                                     │   │
│   │  └─────────────────────────────────────────────────────────────────────┘   │
│   │                                                                             │
│   │  ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  │                        NuGet 第三方依赖                              │   │
│   │  │                                                                     │   │
│   │  │   OpenCvSharp4*.dll                 ← 图像处理核心                 │   │
│   │  │   SharpDX*.dll                      ← GPU加速渲染                  │   │
│   │  │   Vortice*.dll                      ← 现代GPU API                  │   │
│   │  │   Msagl*.dll                        ← 图布局算法                    │   │
│   │  │   SixLabors.ImageSharp.dll          ← 图像编解码                   │   │
│   │  │                                                                     │   │
│   │  └─────────────────────────────────────────────────────────────────────┘   │
│   │                                                                             │
│   └── plugins/  ────────────────────────────────────────────────────────────    │
│       │                                                                         │
│       │  ┌─────────────────────────────────────────────────────────────────┐   │
│       │  │                     工具插件 (9个)                               │   │
│       │  │                                                                 │   │
│       │  │   SunEyeVision.Tool.ColorConvert.dll                            │   │
│       │  │   SunEyeVision.Tool.EdgeDetection.dll                           │   │
│       │  │   SunEyeVision.Tool.GaussianBlur.dll                            │   │
│       │  │   SunEyeVision.Tool.ImageCapture.dll                            │   │
│       │  │   SunEyeVision.Tool.ImageSave.dll                               │   │
│       │  │   SunEyeVision.Tool.OCR.dll                                     │   │
│       │  │   SunEyeVision.Tool.ROICrop.dll                                 │   │
│       │  │   SunEyeVision.Tool.TemplateMatching.dll                        │   │
│       │  │   SunEyeVision.Tool.Threshold.dll                               │   │
│       │  │                                                                 │   │
│       │  └─────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘

3.各层职责一览
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              各层职责一览                                         │
├────────────┬────────────────────┬────────────────────────────────────────────────┤
│   层级     │      项目          │                    职责                         │
├────────────┼────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│  Layer 0   │ Plugin.Abstractions│  📦 SDK层 - 零依赖纯契约                        │
│            │                    │     • 定义核心接口 IImageProcessor             │
│            │                    │     • 定义数据结构 AlgorithmParameters/Result  │
│            │                    │     • 可独立打包为 NuGet                        │
│            │                    │                                                │
├────────────┼────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│  Layer 1   │       Core         │  🌐 领域层 - 核心业务逻辑                       │
│            │                    │     • 图像处理核心实现                          │
│            │                    │     • 日志系统 ILogger                          │
│            │                    │     • 文件访问管理 IFileAccessManager           │
│            │                    │     • 缩略图解码器                              │
│            │                    │                                                │
├────────────┼────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│  Layer 2   │ Plugin.Infrastructure│ ⚙️ 基础设施层 - 插件管理                      │
│            │                    │     • 插件加载器 PluginLoader                   │
│            │                    │     • 插件管理器 PluginManager                  │
│            │                    │     • 工具注册表 ToolRegistry                   │
│            │                    │                                                │
│            ├────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│            │   DeviceDriver     │  🔌 基础设施层 - 设备驱动                       │
│            │                    │     • 相机驱动抽象                              │
│            │                    │     • 图像采集接口                              │
│            │                    │                                                │
├────────────┼────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│  Layer 3   │     Workflow       │  📋 应用层 - 工作流引擎                         │
│            │                    │     • WorkflowEngine 工作流引擎                 │
│            │                    │     • WorkflowExecutionEngine 执行引擎          │
│            │                    │     • WorkflowContext 执行上下文                │
│            │                    │     • 节点系统 WorkflowNode/AlgorithmNode       │
│            │                    │                                                │
├────────────┼────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│  Layer 4   │        UI          │  🖥️ 表现层 - WPF用户界面                        │
│            │                    │     • 主窗口 MainWindow                         │
│            │                    │     • 工具箱 ToolboxView                        │
│            │                    │     • 画布 DiagramCanvas                        │
│            │                    │     • 属性面板 PropertyView                     │
│            │                    │                                                │
│            ├────────────────────┼────────────────────────────────────────────────┤
│            │                    │                                                │
│            │     Tool.* (9个)   │  🔧 插件层 - 视觉算法工具                       │
│            │                    │     • 只依赖 Plugin.Abstractions               │
│            │                    │     • 可独立开发、测试、分发                    │
│            │                    │                                                │
└────────────┴────────────────────┴────────────────────────────────────────────────┘
